/*! inline-worker-0.1.0 09-04-2013 */
(function(e){"use strict";function t(){return!!e.Worker}function r(e){if(!t())throw Error("Web Worker is not supported");return this instanceof r?(this.fnBody="self.onmessage = function (event) { self.postMessage(("+(""+e)+").call(self, event.data)) };",this.worker=this.resolve=this.reject=this.onmessage=this.onerror=null,this.injected=[],void 0):new r(e)}r.prototype={constructor:r,_assertWorker:function(){var t;this.worker||(t=new Blob([this.fnBody].concat(this.injected),{type:"application/javascript"}),this.worker=new Worker(e.URL.createObjectURL(t)))},run:function(e,t){return this._assertWorker(),this.worker.postMessage(e,t||null),this.worker.onmessage=this._onMessage.bind(this),this.worker.onerror=this._onError.bind(this),this},_onMessage:function(e){this.resolve=e.data,this.onmessage&&this.onmessage(e.data)},_onError:function(e){this.reject=e,this.onerror&&this.onerror(e.message,e.filename,e.lineno,e)},then:function(e,t){var r;return this._assertWorker(),"function"==typeof e&&(this.onmessage=e,this.resolve&&this.onmessage(this.resolve)),"function"==typeof t&&(this.onerror=t,this.reject&&(r=this.reject,this.onerror(r.message,r.filename,r.lineno,r))),this},inject:function(){for(var e,t=Array.prototype.slice.call(arguments),r=t.length,s=0;r>s;s++)e=t[s],"function"==typeof e&&this.injected.push(""+e);return this}},e.InlineWorker=r})(window);